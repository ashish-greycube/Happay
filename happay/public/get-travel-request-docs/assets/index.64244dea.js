import{r as k,u as W,a as ae,c as T,w as J,n as oe,o as f,b as M,d as b,e as p,f as o,P as re,g as P,h as z,i as A,j as t,k as N,l as x,t as D,C as ne,m as K,Q as ie,X as Q,p as ue,F as X,q as Y,s as B,Y as de,v as G,x as Z,J as ce,y as ee,z as pe,A as ve,_ as te,B as me,D as fe,E as ge,G as le,H as be,I as ye,K as E,L as O,M as H,N as he,O as _e,R as xe,S as we,T as ke,U as Ce,V as Ve,W as $e}from"./vendor.6e4c61e1.js";const qe=function(){const q=document.createElement("link").relList;if(q&&q.supports&&q.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))v(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&v(c)}).observe(document,{childList:!0,subtree:!0});function y(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerpolicy&&(n.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?n.credentials="include":l.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function v(l){if(l.ep)return;l.ep=!0;const n=y(l);fetch(l.href,n)}};qe();const Se={class:"w-full"},Pe=["onClick"],De={class:"flex items-center"},Le={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},Te={key:1,class:"text-base leading-5 text-gray-500"},Re={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},Ie={class:"relative px-1.5 pt-0.5"},je={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-gray-500"},ze={class:"flex flex-col space-y-1"},Ae=["innerHTML"],Be={key:0,class:"mt-1.5 rounded-md px-2.5 py-1.5 text-base text-gray-600"},Ue={key:0,class:"border-t p-1.5 pb-0.5"},Ne={__name:"Autocomplete",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","update:query","change"],setup(R,{expose:q,emit:y}){const v=R,l=y,n=k(""),c=k(!1),C=k(null),g=W(),h=ae(),S=T(()=>"value"in g),V=T({get(){return S.value?g.value:v.modelValue},set(a){n.value="",a&&(c.value=!1),l(S.value?"change":"update:modelValue",a)}});function s(){c.value=!1}const i=T(()=>{var d;return!v.options||v.options.length==0?[]:(((d=v.options[0])==null?void 0:d.group)?v.options:[{group:"",items:v.options}]).map((m,r)=>({key:r,group:m.group,hideLabel:m.hideLabel||!1,items:v.filterable?_(m.items):m.items})).filter(m=>m.items.length>0)});function _(a){return n.value?a.filter(d=>[d.label,d.value].some(r=>(r||"").toString().toLowerCase().includes(n.value.toLowerCase()))):a}function $(a){if(typeof a=="string"){let m=i.value.flatMap(r=>r.items).find(r=>r.value===a);return(m==null?void 0:m.label)||a}return a==null?void 0:a.label}J(n,a=>{l("update:query",a)}),J(c,a=>{a&&oe(()=>{C.value.el.focus()})});const L=T(()=>v.disabled?"text-gray-600":"text-gray-800"),F=T(()=>{let a={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[v.size],d={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[v.size],m=v.disabled?"disabled":v.variant,r={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",v.variant==="outline"?"border-gray-300":"border-transparent"]}[m];return[a,d,r,L.value,"transition-colors w-full"]});return q({query:n}),(a,d)=>(f(),M(o(ce),{modelValue:V.value,"onUpdate:modelValue":d[3]||(d[3]=m=>V.value=m),nullable:""},{default:b(({open:m})=>[p(o(re),{class:"w-full",show:c.value,"onUpdate:show":d[2]||(d[2]=r=>c.value=r)},{target:b(({open:r,togglePopover:e})=>[P(a.$slots,"target",z(A({open:r,togglePopover:e})),()=>[t("div",Se,[t("button",{class:N(["flex w-full items-center justify-between focus:outline-none",F.value]),onClick:()=>e()},[t("div",De,[P(a.$slots,"prefix"),V.value?(f(),x("span",Le,D($(V.value)),1)):(f(),x("span",Te,D(R.placeholder||""),1))]),p(o(ne),{class:"h-4 w-4 stroke-1.5"})],10,Pe)])])]),body:b(({isOpen:r})=>{var e;return[K(t("div",null,[t("div",Re,[t("div",Ie,[p(o(ie),{ref_key:"search",ref:C,class:"form-input w-full",type:"text",onChange:d[0]||(d[0]=w=>{n.value=w.target.value}),value:n.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),t("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:d[1]||(d[1]=w=>V.value=null)},[p(o(Q),{class:"h-4 w-4 stroke-1.5"})])]),p(o(ue),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:b(()=>[(f(!0),x(X,null,Y(i.value,w=>K((f(),x("div",{class:"mt-1.5",key:w.key},[w.group&&!w.hideLabel?(f(),x("div",je,D(w.group),1)):B("",!0),(f(!0),x(X,null,Y(w.items,u=>(f(),M(o(de),{as:"template",key:u.value,value:u},{default:b(({active:I,selected:j})=>[t("li",{class:N(["flex items-center rounded px-2.5 py-2 text-base",{"bg-gray-100":I}])},[P(a.$slots,"item-prefix",G({ref_for:!0},{active:I,selected:j,option:u})),P(a.$slots,"item-label",G({ref_for:!0},{active:I,selected:j,option:u}),()=>[t("div",ze,[t("div",null,D(u.label),1),u.label!=u.description?(f(),x("div",{key:0,class:"text-xs text-gray-700",innerHTML:u.description},null,8,Ae)):B("",!0)])])],2)]),_:2},1032,["value"]))),128))])),[[Z,w.items.length>0]])),128)),i.value.length==0?(f(),x("li",Be," No results found ")):B("",!0)]),_:3}),o(h).footer?(f(),x("div",Ue,[P(a.$slots,"footer",z(A({value:(e=C.value)==null?void 0:e.el._value,close:s})))])):B("",!0)])],512),[[Z,r]])]}),_:3},8,["show"])]),_:3},8,["modelValue"]))}},Oe={class:"space-y-1.5"},Fe={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:Object,default:()=>({})},modelValue:{type:String,default:""}},emits:["update:modelValue","change"],setup(R,{emit:q}){const y=R,v=q,l=W(),n=T(()=>"value"in l),c=T({get:()=>n.value?l.value:y.modelValue,set:s=>(s==null?void 0:s.value)&&v(n.value?"change":"update:modelValue",s==null?void 0:s.value)}),C=k(null),g=k("");ee(()=>{var s;return(s=C.value)==null?void 0:s.query},s=>{s=s||"",g.value!==s&&(g.value=s,S(s))},{debounce:300,immediate:!0}),ee(()=>y.doctype,()=>S(""),{debounce:300,immediate:!0});const h=pe({url:"frappe.desk.search.search_link",cache:[y.doctype,g.value],method:"POST",auto:!0,params:{txt:g.value,doctype:y.doctype,filters:y.filters},transform:s=>s.map(i=>({label:i.value,value:i.value,description:i.description}))});function S(s){h.update({params:{txt:s,doctype:y.doctype,filters:y.filters}}),h.reload()}const V=T(()=>[{sm:"text-xs",md:"text-base"}[l.size||"sm"],"text-gray-600"]);return(s,i)=>(f(),x("div",Oe,[o(l).label?(f(),x("label",{key:0,class:N(["block",V.value])},D(o(l).label),3)):B("",!0),p(Ne,{ref_key:"autocomplete",ref:C,options:o(h).data,modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=_=>c.value=_),size:o(l).size||"sm",variant:o(l).variant,placeholder:o(l).placeholder,filterable:!1},ve({target:b(({open:_,togglePopover:$})=>[P(s.$slots,"target",z(A({open:_,togglePopover:$})))]),prefix:b(()=>[P(s.$slots,"prefix")]),"item-prefix":b(({active:_,selected:$,option:L})=>[P(s.$slots,"item-prefix",z(A({active:_,selected:$,option:L})))]),"item-label":b(({active:_,selected:$,option:L})=>[P(s.$slots,"item-label",z(A({active:_,selected:$,option:L})))]),_:2},[o(l).onCreate?{name:"footer",fn:b(({value:_,close:$})=>[t("div",null,[p(o(te),{variant:"ghost",class:"w-full !justify-start",label:"Create New",onClick:L=>o(l).onCreate(_,$)},{prefix:b(()=>[p(o(me),{class:"h-4 w-4 stroke-1.5"})]),_:2},1032,["onClick"])])]),key:"0"}:void 0]),1032,["options","modelValue","size","variant","placeholder"])]))}},Me={class:"grid place-content-center pt-10"},Ee={class:"flex-col w-[35rem] p-2 my-2 shadow-md"},He={class:"text-center text-red-500"},We={class:"p-2"},Je={class:"p-2"},Ke={class:"p-2"},Qe={class:"p-2"},Xe={class:"p-2"},Ye={class:"text-center p-2"},Ge={class:"p-2 text-center",required:!0},Ze={class:"mb-4"},et={key:1,class:"mb-4"},tt={class:"flex items-center"},lt={class:"border rounded-md p-2 mr-2"},st={class:"flex flex-col"},at={class:"text-center p-5"},ot={class:"text-center p-2"},rt={class:"text-center p-2"},nt={__name:"App",setup(R){const q=new URL(window.location.href),y=new URLSearchParams(q.search);let l=Object.fromEntries(y).name;const n=fe("$translate"),c=k(""),C=k(""),g=k(""),h=k(""),S=k(""),V=k(""),s=k(""),i=ge({invoice_image:null,travelDoc:""});i.travelDoc=l;const _=r=>{i.invoice_image=r},$=()=>{i.invoice_image=null};function L(r){let e=r.name.split(".").pop().toLowerCase();if(!["png","jpg","jpeg","pdf","xls","xlsx"].includes(e))return n("Only Images, Excel and Pdf are allowed")}function F(){var r;if(console.log(c.value,Date.now(),Date.now()<new Date(c.value)," Date.now() < invoiceDate.value"),console.log(g.value<h.value,g.value,h.value,"billAmount.value < serviceCharges.value"),!i.travelDoc)return V.value="Please select Project Travel Request",!1;if(!((r=i.invoice_image)==null?void 0:r.file_url))return V.value="Invoice is Required.",!1;if(parseFloat(g.value)<parseFloat(h.value))return S.value="Service Charge should not be more than Bill Amount.",!1;if(Date.now()<new Date(c.value))return S.value="Supplier Invoice Date should not be greater than today",!1}const a=le({doctype:"Project Travel Request",fields:["name","bill_amount","service_charge","ticket_attachment","invoice_attachment","supplier_invoice_number","supplier_invoice_date"]});let d=le({doctype:"Project Travel Request",fields:["name"],filters:{workflow_state:["=","Pending at TA"]},pageLength:99999});be(()=>{d.data==null&&d.fetch()});function m(){var r;F()!=!1&&(a.setValue,a.setValue.submit({name:i.travelDoc,supplier_invoice_date:c.value,supplier_invoice_number:C.value,bill_amount:g.value,service_charge:h.value,invoice_attachment:((r=i.invoice_image)==null?void 0:r.file_url)||""},{onSuccess(){window.location.replace("/success-page"),console.log("Successs"),console.log(a,"======travelReq"),c.value="",C.value="",i.travelDoc="",g.value="",h.value="",i.invoice_image=null},onError(){console.log("Error!!"),s.value="Something Went Wrong."}}))}return(r,e)=>{const w=ye("Button");return f(),x("div",Me,[t("div",Ee,[e[10]||(e[10]=t("p",{class:"text-3xl p-2 text-center"},"Project Travel Request",-1)),e[11]||(e[11]=t("br",null,null,-1)),t("div",He,[e[7]||(e[7]=t("span",{class:"text-xl italic font-medium"},"Pending at TA ",-1)),E(" Count (s) : "+D(o(d).data.length),1)]),e[12]||(e[12]=t("br",null,null,-1)),t("div",null,[t("div",We,[p(Fe,{modelValue:i.travelDoc,"onUpdate:modelValue":e[0]||(e[0]=u=>i.travelDoc=u),doctype:"Project Travel Request",label:"Project Travel Request",required:!0,filters:{docstatus:1,workflow_state:"Pending at TA"}},null,8,["modelValue"])]),t("div",Je,[p(o(O),{type:"date",ref_for:!0,size:"md",variant:"subtle",placeholder:"Supplier Invoice Date",disabled:!1,required:r.required,label:"Supplier Invoice Date",modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=u=>c.value=u)},null,8,["required","modelValue"])]),t("div",Ke,[p(o(O),{type:"text",ref_for:!0,size:"md",variant:"subtle",placeholder:"Supplier Invoice Number",disabled:!1,label:"Supplier Invoice Number",modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=u=>C.value=u),class:N(r.required&&"reqd")},null,8,["modelValue","class"])]),t("div",Qe,[p(o(O),{type:"number",ref_for:!0,size:"md",variant:"subtle",placeholder:"Bill Amount",disabled:!1,label:"Bill Amount",required:!0,modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=u=>g.value=u)},null,8,["modelValue"])]),t("div",Xe,[p(o(O),{type:"number",ref_for:!0,size:"md",variant:"subtle",placeholder:"Service Charges",disabled:!1,label:"Service Charges",modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=u=>h.value=u),required:""},null,8,["modelValue"])]),t("div",Ye,[p(o(H),{message:S.value},null,8,["message"])]),t("div",Ge,[i.invoice_image?(f(),x("div",et,[e[8]||(e[8]=t("div",{class:"text-xs text-gray-600 mb-1"},D("Invoice"),-1)),t("div",tt,[t("div",lt,[p(o(_e),{class:"h-5 w-5 stroke-1.5 text-gray-700"})]),t("div",st,[t("span",null,D(i.invoice_image.file_name),1)]),p(o(Q),{onClick:e[6]||(e[6]=u=>$()),class:"bg-gray-200 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4"})])])):(f(),M(o(he),{key:0,fileTypes:["image/*"],validateFile:L,onSuccess:e[5]||(e[5]=u=>_(u))},{default:b(({file:u,progress:I,uploading:j,openFileSelector:se})=>[t("div",Ze,[p(w,{onClick:se,loading:j},{default:b(()=>[E(D(j?`Uploading ${I}%`:"Upload a Invoice"),1)]),_:2},1032,["onClick","loading"])])]),_:1}))])]),t("div",at,[p(w,{class:"p-2",variant:"solid",ref_for:!0,theme:"gray",size:"md",label:"Button",loading:!1,loadingText:null,disabled:!1,onClick:m},{default:b(()=>e[9]||(e[9]=[E(" Send Request ")])),_:1}),t("div",ot,[p(o(H),{message:V.value},null,8,["message"])]),t("div",rt,[p(o(H),{message:s.value},null,8,["message"])])])])])}}};let U=xe(nt);we("resourceFetcher",$e);U.use(ke);U.component("Button",te);U.component("Card",Ce);U.component("Input",Ve);U.mount("#app");
